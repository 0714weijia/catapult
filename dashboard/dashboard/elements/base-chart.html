  <script>
    'use strict';
    Polymer({

      is: 'base-chart',

      properties: {
        chartTitle: {
        },
        units: {
        },
        flotData: {
        },
        chartOptions: {
          value: function() { return {} }
        }
      },

      getChartOptions: function() {
        return {};
      },

      observers: [
        'updateChart(flotData, chartOptions)'
      ],

      /**
       * Initializes the summary-chart element and its properties.
       * This is a custom element lifecycle callback that's called when an
       * instance of the element is "ready".
       */
      ready: function() {
        console.debug('ready', this.chartTitle, Date.now());
        // Set up chart resize handler.
        this.resizeHandler = this.onResize.bind(this);
        this.resizeTimer = null;
        this.drawable = true;
        window.addEventListener('resize', this.resizeHandler);
      },

      /**
       * Initializes the chart when it's actually attached to the DOM.
       * This is a custom element lifecycle callback.
       */
      attached: function() {
        console.debug('attached', this.chartTitle, Date.now());
        if (!this.flotData) {
          console.debug('attached', this.chartTitle, '!this.flotData');
        }
      },

      /**
       * Updates the state if the chart is removed from view.
       */
      leftView: function() {
        console.debug('leftView', this.chartTitle, Date.now());
        this.drawable = false;
        window.removeEventListener('resize', this.resizeHandler);
      },

      /**
       * Plots the data on the chart.
       */
      updateChart: function(flotData, chartOptions) {
        if (!this.drawable) {
          console.debug('updateChart', this.chartTitle, '!drawable');
          return;
        }
        this.chart = $.plot(this.$.plot, flotData, chartOptions);
      },

      /**
       * Sets a timer to resize the chart after certain time delay.
       * The resize timer variable and timeout are used because we want to
       * void resizing graph until the user has stopped resizing.
       * @param {Event} event
       */
      onResize: function(event) {
        clearTimeout(this.resizeTimer);
        this.resizeTimer = setTimeout(this.resizeGraph.bind(this), 100);
      },

      /**
       * Resizes the chart if it's present.
       */
      resizeGraph: function() {
        if (!this.chart) {
          return;
        }
        this.updateChart();
      }
    });
  </script>
