<!DOCTYPE html>
<!--
Copyright 2015 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->
<link rel="import" href="/tracing/base/guid.html">

<link rel="import" href="/perf_insights/mre/function_handle.html">

<script>
'use strict';

tr.exportTo('pi.mre', function() {

  function Job(mapFunctionHandle, reduceFunctionHandle, opt_guid) {
    this.mapFunctionHandle_ = mapFunctionHandle;
    this.reduceFunctionHandle_ = reduceFunctionHandle;
    if (opt_guid === undefined)
      this.guid_ = tr.b.GUID.allocate();
    else
      this.guid_ = opt_guid;
  }

  Job.prototype = {
    get mapFunctionHandle() { return this.mapFunctionHandle_; },
    get reduceFunctionHandle() { return this.reduceFunctionHandle_; },
    get guid() { return this.guid_; },

    asDict: function() {
      return {
        map_function_handle: this.mapFunctionHandle_.asDict(),
        reduce_function_handle: this.reduceFunctionHandle._asDict(),
        guid: this.guid_.toString()
      };
    }
  };

  Job.fromDict = function(jobDict) {
    var mapFunctionHandle = pi.mre.FunctionHandle.fromDict(
        jobDict.map_function_handle);
    // TODO(eakuefner): deserialize reducer

    return new Job(mapFunctionHandle, undefined, jobDict.guid);
  };

  return {
    Job: Job
  };
});
